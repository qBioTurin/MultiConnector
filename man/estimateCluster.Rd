% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimateCluster.R
\name{estimateCluster}
\alias{estimateCluster}
\title{Estimate Clustering Parameters and Solutions}
\usage{
estimateCluster(
  CONNECTORData,
  G,
  p,
  h = NULL,
  runs = 50,
  seed = 2404,
  cores = 1,
  PercPCA = 0.85,
  MinErrFreq = 0,
  pert = 0.01
)
}
\arguments{
\item{CONNECTORData}{A CONNECTORData object created with \code{\link{ConnectorData}}.
Contains the time series data, annotations, and time grids to be clustered.}

\item{G}{Integer vector specifying the range of cluster numbers to evaluate (e.g., 2:6).
The algorithm will test each specified number of clusters.}

\item{p}{Named vector or single integer specifying the dimension of the natural cubic
spline basis for each measurement type. Higher values capture more complex curve shapes
but may lead to overfitting. See \code{\link{estimatepDimension}} for guidance.}

\item{h}{Projection dimension parameter. Must be ≤ min(p, G-1) for identifiability.
Lower values provide simpler representations but may lose important curve features.
Default is typically 2 or 3.}

\item{runs}{Integer specifying the number of random initializations for each parameter
combination. More runs improve stability but increase computation time. Default: 50.}

\item{seed}{Integer seed for reproducible results. Ensures consistent random initializations
across runs.}

\item{cores}{Integer specifying the number of CPU cores for parallel computation.
Speeds up analysis for large datasets or many parameter combinations.}

\item{PercPCA}{Numeric (0-1) specifying the minimum percentage of variance to retain
in PCA preprocessing. Default: 0.85 (85\% of variance retained).}

\item{MinErrFreq}{Minimum error frequency threshold for stability assessment.}

\item{pert}{Perturbation parameter for numerical stability in optimization.}
}
\value{
A comprehensive list containing:
\itemize{
\item \code{Clusterings}: List of all clustering solutions for each G and run
\item \code{QualityMetrics}: Data frame with quality metrics (fDB, silhouette, etc.)
for each solution
\item \code{ConsensusInfo}: Consensus matrices and stability measures across runs
\item \code{Parameters}: Summary of all tested parameter combinations
\item \code{seed}: The random seed used for reproducibility
}
}
\description{
Performs comprehensive clustering analysis using the Functional Clustering Model approach.
This function fits multiple clustering solutions with different numbers of clusters and
parameters, running multiple iterations to ensure stability and robustness. The method
is particularly suited for functional/longitudinal data where curves are clustered based
on their shape and temporal patterns.
}
\details{
\strong{Clustering Approach:}
The function implements functional clustering based on the Sugar & James model, which:
\itemize{
\item Projects curves onto a lower-dimensional space using spline coefficients
\item Clusters curves based on their projected representations
\item Accounts for within-curve correlation and measurement error
}

\strong{Parameter Selection Guidelines:}
\itemize{
\item \strong{G}: Start with 2-6 clusters, extend based on domain knowledge
\item \strong{p}: Use \code{estimatepDimension()} to find optimal spline dimensions
\item \strong{h}: Usually 2-3, must be ≤ min(p, G-1)
\item \strong{runs}: 50-100 for final analysis, 10-20 for exploration
}

\strong{Quality Assessment:}
Multiple quality metrics are computed including functional Data Depth (fDB),
silhouette scores, and stability measures to help identify optimal solutions.
}
\examples{
\dontrun{
# Basic clustering analysis
results <- estimateCluster(
  CONNECTORData = my_data,
  G = 2:5,
  p = c("measure1" = 4, "measure2" = 3),
  h = 2,
  runs = 50,
  cores = 4
)

# Quick exploration with fewer runs
quick_results <- estimateCluster(
  CONNECTORData = my_data,
  G = 2:4,
  p = 3,
  h = 2,
  runs = 10,
  cores = 2
)
}

}
\seealso{
\code{\link{ConnectorData}} for creating input data objects,
\code{\link{estimatepDimension}} for selecting spline dimensions,
\code{\link{selectCluster}} for choosing optimal solutions,
\code{\link{validateCluster}} for validating results
}
\author{
Cordero Francesca, Pernice Simone, Sirovich Roberta
}
